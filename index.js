/**
 * qi-nodes 0.0.4
 * http://drkibitz.github.io/qi-nodes/
 * Copyright (c) 2013 Dr. Kibitz, http://drkibitz.com
 * Base implementation for composite patterns in JavaScript.
 * built: Wed Feb 12 2014 22:13:27 GMT-0800 (PST)
 */
!function(i,t){"use strict";function n(i){this.message=i||"A NodeObject was inserted somewhere it doesn't belong."}function e(i){i.childCount=0,i.firstChild=i.lastChild=i.nextSibling=i.parent=i.previousSibling=i.root=null}function r(i){var t=i.parent,n=i.nextSibling,e=i.previousSibling;return t.childCount--,n?n.previousSibling=e:t.lastChild=e,e?e.nextSibling=n:t.firstChild=n,i.parent=i.nextSibling=i.previousSibling=null,i}function o(i){var t=i.root,n=i.parent?i.parent.root:null;t&&i.onRemoved&&i.onRemoved(t),n&&i.onInserted&&i.onInserted(n),i.root=n}function l(i){e(this),i&&this.appendTo(i)}n.prototype=new Error,n.prototype.name="HierarchyRequestError";var s=l.prototype;s.append=function(i,t){return this.appendTo(t||this,i)},s.appendTo=function(i,t){var e,l=i.lastChild;if(t=t||this,t==i)throw new n;return t!=l&&(t.parent&&r(t),t.parent=i,e=0|i.childCount,i.childCount=e+1,l&&(t.previousSibling=l,l.nextSibling=t),i.lastChild=t,i.firstChild||(i.firstChild=t),t.root!=i.root&&this.each(o,t)),t},s.create=function(i){return new l(i)},s.createRoot=function(){var i=new l;return i.root=i,i},s.destroy=function(i,t){return t=t||this,i?this.eachReverse(e,t):(t.root=null,t.parent&&r(t),t.firstChild&&this.empty(i,t)),t},s.each=function h(i,t,n){var e,r;for(t=t||this,n=0|n,e=t.firstChild,i(t,n);e;)r=e.nextSibling,h(i,e,n+1),e=r;return t},s.eachParent=function u(i,t,n){return t=t||this,n=0|n,t.parent&&u(i,t.parent,n+1),i(t,n),t},s.eachReverse=function a(i,t,n){var e,r;for(t=t||this,n=0|n,e=t.lastChild;e;)r=e.previousSibling,a(i,e,n+1),e=r;return i(t,n),t},s.empty=function(i,t){var n,r;for(t=t||this,n=t.firstChild,n&&i&&(t.childCount=0,t.firstChild=t.lastChild=null);n;)r=n.nextSibling,i?this.eachReverse(e,n):this.remove(n),n=r;return t},s.insertAfter=function(i,t){var e,l,s=i.nextSibling;if(t=t||this,t!=i&&t!=s){if(e=i.parent,!e||t==e)throw new n;t.parent&&r(t),t.previousSibling=i,t.nextSibling=s,t.parent=e,s?s.previousSibling=t:e.lastChild=t,i.nextSibling=t,l=0|e.childCount,e.childCount=l+1,t.root!=e.root&&this.each(o,t)}return t},s.insertBefore=function(i,t){var e,l,s=i.previousSibling;if(t=t||this,t!=i&&t!=s){if(e=i.parent,!e||t==e)throw new n;t.parent&&r(t),t.previousSibling=s,t.nextSibling=i,t.parent=e,s?s.nextSibling=t:e.firstChild=t,i.previousSibling=t,l=0|e.childCount,e.childCount=l+1,t.root!=e.root&&this.each(o,t)}return t},s.prepend=function(i,t){return this.prependTo(t||this,i)},s.prependTo=function(i,t){var e,l=i.firstChild;if(t=t||this,t==i)throw new n;return t!=l&&(t.parent&&r(t),t.parent=i,e=0|i.childCount,i.childCount=e+1,l&&(t.nextSibling=l,l.previousSibling=t),i.firstChild=t,i.lastChild||(i.lastChild=t),t.root!=i.root&&this.each(o,t)),t},s.remove=function(i){return i=r(i||this),i.root?this.each(o,i):i},s.swap=function(i,t){var n,e,r,l,s,h=i.nextSibling;return t=t||this,i!=t&&(n=i.parent,e=i.previousSibling,r=t.nextSibling,l=t.parent,s=t.previousSibling,i.nextSibling=r,i.parent=l,i.previousSibling=s,r?r.previousSibling=i:l&&(l.lastChild=i),s?s.nextSibling=i:l&&(l.firstChild=i),t.nextSibling=h,t.parent=n,t.previousSibling=e,h?h.previousSibling=t:n&&(n.lastChild=t),e?e.nextSibling=t:n&&(n.firstChild=t),(i.root&&!l||i.root!=l.root)&&this.each(o,i),(t.root&&!n||t.root!=n.root)&&this.each(o,t)),i},t=i.exports=s.createRoot(),t.HierarchyRequestError=n,t.NodeObject=l}(module,exports);